(self.webpackChunk_mozaic_ds_angular_chart=self.webpackChunk_mozaic_ds_angular_chart||[]).push([[932],{"./src/components/bar/bar-chart.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,MultipleData:()=>MultipleData,StackedBarChart:()=>StackedBarChart,__namedExportsOrder:()=>__namedExportsOrder,default:()=>bar_chart_stories});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var bar_chart_componentngResource=__webpack_require__("./src/components/bar/bar-chart.component.scss?ngResource"),bar_chart_componentngResource_default=__webpack_require__.n(bar_chart_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),ng2_charts=__webpack_require__("./node_modules/ng2-charts/fesm2022/ng2-charts.mjs"),chart=__webpack_require__("./node_modules/chart.js/dist/chart.js"),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),mozaic_ds_angular=__webpack_require__("./node_modules/@mozaic-ds/angular/adeo/fesm2020/mozaic-ds-angular.mjs"),chart_design=__webpack_require__("./src/patterns/chart-design.ts"),BehaviorSubject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js"),pattern_service=__webpack_require__("./src/services/pattern.service.ts"),color_function_service=__webpack_require__("./src/services/color-function.service.ts"),chart_legend_service=__webpack_require__("./src/services/chart-legend.service.ts");let BarChartFunctionsService=class BarChartFunctionsService{patternService;colorFunctionService;chartLegendService;barChartRef=new BehaviorSubject.t(null);onHoverIndex=new BehaviorSubject.t({dataSetIndex:-1,columnIndex:-1});borderWidth=new BehaviorSubject.t(3);constructor(patternService,colorFunctionService,chartLegendService){this.patternService=patternService,this.colorFunctionService=colorFunctionService,this.chartLegendService=chartLegendService}privateGetHtmlLegendPlugin(legendContainer,selectMode,disableAccessibility,patternsColors,patternsList,enableHoverFeature){return this.chartLegendService.getHtmlLegendPlugin(legendContainer,selectMode,this.onHoverIndex,disableAccessibility,patternsColors,patternsList,enableHoverFeature)}getStackedDatasets(datasets,stackDatasets,disableAccessibility,patternsColors,patternsList,patternShifting){const barChartFunctionService=this,borderWithValue=this.borderWidth.value;return datasets.map(((dataset,datasetIndex)=>({borderColor:function(context){return disableAccessibility?"#00000000":barChartFunctionService.getBorderColor(datasetIndex,context.index,patternsColors,patternShifting)},backgroundColor:function(context){return barChartFunctionService.getPattern(datasetIndex,context.index,disableAccessibility,patternsColors,patternsList,patternShifting)},borderWidth:function(){return disableAccessibility?1:borderWithValue},categoryPercentage:.8,barPercentage:.64,data:dataset.data,label:dataset.label,stack:`Stack ${stackDatasets?dataset.stack:datasetIndex}`})))}getOnHoverOptions(){return(_ignore,activeElements)=>{void 0!==activeElements[0]?(this.onHoverIndex.value.dataSetIndex=activeElements[0].datasetIndex,this.onHoverIndex.value.columnIndex=activeElements[0].index):this.resetOnHoverIndex()}}getBorderColor(dataSetIndex,contextIndex,patternsColors,patternShifting){const index=this.patternService.getPatternIndexWithShift(dataSetIndex,patternShifting);return this.displayFullOpacity(dataSetIndex,contextIndex)?patternsColors[index]:this.colorFunctionService.addAlpha(patternsColors[index],.2)}getPattern(dataSetIndex,contextIndex,disableAccessibility,patternsColors,patternsList,patternShifting){const index=this.patternService.getPatternIndexWithShift(dataSetIndex,patternShifting);return this.displayFullOpacity(dataSetIndex,contextIndex)?patternsList[index](!1,patternsColors[index],disableAccessibility):patternsList[index](!0,patternsColors[index],disableAccessibility)}nothingHovered(){return this.onHoverIndex.value.dataSetIndex<0}columnHovered(dataSetIndex,contextIndex){return this.onHoverIndex.value.dataSetIndex===dataSetIndex&&this.onHoverIndex.value.columnIndex===contextIndex}legendHovered(dataSetIndex){return this.onHoverIndex.value.dataSetIndex===dataSetIndex&&this.onHoverIndex.value.columnIndex<0}displayFullOpacity(dataSetIndex,contextIndex){return this.nothingHovered()||this.columnHovered(dataSetIndex,contextIndex)||this.legendHovered(dataSetIndex)}resetOnHoverIndex(){this.onHoverIndex.next({dataSetIndex:-1,columnIndex:-1})}static ctorParameters=()=>[{type:pattern_service.s},{type:color_function_service.S},{type:chart_legend_service.bR}]};BarChartFunctionsService=(0,tslib_es6.Cg)([(0,core.Injectable)({providedIn:"root"})],BarChartFunctionsService);var generic_tooltip_service=__webpack_require__("./src/services/generic-tooltip.service.ts"),format_utilities_service=__webpack_require__("./src/services/format-utilities.service.ts"),tooltip_chart_type=__webpack_require__("./src/types/tooltip-chart-type.ts");chart.t1.register(chart.hE,chart.m_,chart.s$,chart.E8,chart.PP,chart.kc);let BarChartComponent=class BarChartComponent{barChartFunctionService;formatUtilitiesService;genericTooltipService;legendContainerElementRef;selectMode=new BehaviorSubject.t(!1);legendContainer=new BehaviorSubject.t(null);xValue;yValue;barChartData={labels:[],datasets:[]};chartId="radar-chart";unit="%";labels=[];colourSet=0;newPatternsOrder=[0,1,2,3,4,5];datasets=[];width="400px";height="300px";styles={};plugins=[];stacked=!1;disableAccessibility=!1;enableHoverFeature=!1;xAxisTitle=null;yAxisTitle=null;tooltipFirstLineLabel="content";tooltipSecondLineLabel="content2";barChartOptions;barChartPlugins=[];colourSets=(0,chart_design.A)().colourSets;patternsStandardList=(0,chart_design.A)().patternsStandardList;constructor(barChartFunctionService,formatUtilitiesService,genericTooltipService){this.barChartFunctionService=barChartFunctionService,this.formatUtilitiesService=formatUtilitiesService,this.genericTooltipService=genericTooltipService}ngAfterViewInit(){this.legendContainer.next(this.legendContainerElementRef?.nativeElement);const chartsLabels=this.getChartLabels(this.indexOfOthersLabelIfNull());this.gettooltipContent(),this.initializeChartOptions(),this.barChartData={labels:chartsLabels,datasets:this.barChartFunctionService.getStackedDatasets(this.datasets.map(((dataset,index)=>({data:this.getChartData(index,this.indexOfOthersLabelIfNull()),label:this.datasets[index].label,stack:dataset.stack??0}))),this.stacked,this.disableAccessibility,this.patternsColors(),this.patternsOrderedList(),0)},this.barChartOptions.onHover=(event,elements,chart)=>{chart&&(this.enableHover()&&this.barChartFunctionService.getOnHoverOptions(),chart.canvas.style.cursor=0!==elements.length?"pointer":"default")},this.barChartPlugins.push(this.barChartFunctionService.privateGetHtmlLegendPlugin(this.legendContainer,this.selectMode,this.disablePattern(),this.patternsColors(),this.patternsOrderedList(),this.enableHover()))}initializeChartOptions(){this.barChartOptions={elements:{bar:{borderSkipped:!1}},plugins:{legend:{display:!1},title:{display:!1},tooltip:{enabled:!1,external:context=>{const dataIndex=context.tooltip.dataPoints?.[0].dataIndex??0;this.labels[dataIndex]&&""!==this.labels[dataIndex]&&this.genericTooltipService.createTooltip(context,this.getTooltipData.bind(this),{chartType:tooltip_chart_type.Y.BAR_CHART,firstLineLabel:this.xValue,secondLineLabel:this.yValue},this.patternsColors(),this.patternsOrderedList(),this.disableAccessibility)}}},scales:{x:{stacked:this.stacked,title:{display:null!==this.xAxisTitle,text:this.xAxisTitle??""}},y:{stacked:this.stacked,title:{display:null!==this.yAxisTitle,text:this.yAxisTitle??""},ticks:{callback:val=>"%"===this.unit?this.formatUtilitiesService.formatTicks(val,this.unit):this.formatUtilitiesService.formatWithThousandsSeparators(val)+" "+this.unit}}}}}getChartLabels(indexOfValueToHide){const labels=Object.assign([],this.labels);return indexOfValueToHide&&labels.splice(indexOfValueToHide,1),labels.map((label=>label))}indexOfOthersLabelIfNull(){const labels=this.labels;if(labels.includes("other")){const index=labels.indexOf("other");if(this.datasets[0].data[index].rate+""=="0"&&this.datasets[1].data[index].rate+""=="0")return index}return null}patternsColors(){return this.newPatternsOrder.length!==this.patternsStandardList.length?this.colourSets[this.colourSet]:this.newPatternsOrder.map((id=>this.colourSets[this.colourSet][id]))}patternsOrderedList(){return this.newPatternsOrder.length!==this.patternsStandardList.length?this.patternsStandardList:this.newPatternsOrder.map((id=>this.patternsStandardList[id]))}disablePattern(){return this.disableAccessibility}enableHover(){return this.enableHoverFeature}gettooltipContent(){this.xValue=this.tooltipFirstLineLabel,this.yValue=this.tooltipSecondLineLabel}getChartData(index,indexOfValueToHide,isStacked=!1){const data=Object.assign([],this.datasets[index].data);return indexOfValueToHide&&data.splice(indexOfValueToHide,1),data.map((data=>"%"===this.unit?data.rate:data.amount))}getTooltipData(context){const datasetIndex=context.tooltip.dataPoints[0].datasetIndex,dataIndex=context.tooltip.dataPoints[0].dataIndex,rate=context.tooltip.body[0].lines[0].split(":")[1],rawdata=this.datasets[datasetIndex].data[dataIndex],percent=rawdata.rate?parseFloat(rate.replace(",",".")).toFixed(2)+"% ":"",amountUnit=rawdata.amountUnit?rawdata.amountUnit:"",data=rawdata.amount?this.formatUtilitiesService.formatWithThousandsSeparators(rawdata.amount):"";return percent+(percent&&data?"/ ":"")+data+amountUnit}static ctorParameters=()=>[{type:BarChartFunctionsService},{type:format_utilities_service.D},{type:generic_tooltip_service.w}];static propDecorators={legendContainerElementRef:[{type:core.ViewChild,args:["legendContainer",{read:core.ElementRef}]}],chartId:[{type:core.Input}],unit:[{type:core.Input}],labels:[{type:core.Input}],colourSet:[{type:core.Input}],newPatternsOrder:[{type:core.Input}],datasets:[{type:core.Input}],width:[{type:core.Input}],height:[{type:core.Input}],styles:[{type:core.Input}],plugins:[{type:core.Input}],stacked:[{type:core.Input}],disableAccessibility:[{type:core.Input}],enableHoverFeature:[{type:core.Input}],xAxisTitle:[{type:core.Input}],yAxisTitle:[{type:core.Input}],tooltipFirstLineLabel:[{type:core.Input}],tooltipSecondLineLabel:[{type:core.Input}]}};BarChartComponent=(0,tslib_es6.Cg)([(0,core.Component)({selector:"moz-ng-bar-chart",standalone:!0,imports:[ng2_charts.FR,common.CommonModule,mozaic_ds_angular.q4],template:'<div class="container">\r\n  <div class="main" [ngStyle]="{ width: width, height: height }">\r\n    <canvas\r\n      *ngIf="barChartData"\r\n      baseChart\r\n      [data]="barChartData"\r\n      [options]="barChartOptions"\r\n      [plugins]="barChartPlugins"\r\n      [type]="\'bar\'"\r\n    >\r\n    </canvas>\r\n  </div>\r\n  <moz-checkbox style="display: none"></moz-checkbox>\r\n  <div #legendContainer></div>\r\n</div>\r\n',styles:[bar_chart_componentngResource_default()]})],BarChartComponent);const bar_chart_stories={title:"Charts/Bar",component:BarChartComponent,tags:["autodocs"]},Default={args:{width:"500px",height:"400px",tooltipFirstLineLabel:"content",tooltipSecondLineLabel:"content2",disableAccessibility:!1,newPatternsOrder:[0,4,1,2,3,5],labels:["Data One","Data Two","Data Three"],colourSet:0,xAxisTitle:"X Axis Title",yAxisTitle:"Y Axis Title",datasets:[{label:"Data One",data:[{amount:163790.23,rate:1.719528,amountUnit:"€"},{amount:217064,rate:2.278815,amountUnit:"€"},{amount:9144447.23,rate:96.0016569,amountUnit:"€"}]},{label:"Data Two",data:[{amount:103144.22,rate:1.1232806,amountUnit:"€"},{amount:297474.14,rate:3.2396087,amountUnit:"€"},{amount:8781791.1,rate:95.6371107,amountUnit:"€"}]}],unit:"%"}},MultipleData={args:{width:"700px",height:"400px",tooltipFirstLineLabel:"content",tooltipSecondLineLabel:"content2",disableAccessibility:!1,labels:["Data One","Data Two","Data Three","Data Four","Data Five","Data Six","Data Seven","Data Eight","Data Nine","Data Ten","Data Eleven","Data Twelve"],colourSet:1,datasets:[{label:"Data One",data:[{amount:163790.23,rate:1.719528,amountUnit:"€"},{amount:217064,rate:2.278815,amountUnit:"€"},{amount:9144447.23,rate:6.0016569,amountUnit:"€"},{amount:9144447.23,rate:46.0016569,amountUnit:"€"},{amount:9144447.23,rate:66.0016569,amountUnit:"€"},{amount:9144447.23,rate:9.0016569,amountUnit:"€"},{amount:9144447.23,rate:46.0016569,amountUnit:"€"},{amount:9144447.23,rate:26.0016569,amountUnit:"€"},{amount:9144447.23,rate:81.0016569,amountUnit:"€"},{amount:9144447.23,rate:11.0016569,amountUnit:"€"},{amount:9144447.23,rate:90.0016569,amountUnit:"€"},{amount:9144447.23,rate:50.0016569,amountUnit:"€"}]},{label:"Data Two",data:[{amount:103144.22,rate:1.1232806,amountUnit:"€"},{amount:297474.14,rate:3.2396087,amountUnit:"€"},{amount:8781791.1,rate:95.6371107,amountUnit:"€"},{amount:8781791.1,rate:45.6371107,amountUnit:"€"},{amount:8781791.1,rate:40.6371107,amountUnit:"€"},{amount:8781791.1,rate:6.6371107,amountUnit:"€"},{amount:8781791.1,rate:7.6371107,amountUnit:"€"},{amount:8781791.1,rate:39.6371107,amountUnit:"€"},{amount:8781791.1,rate:30.6371107,amountUnit:"€"},{amount:8781791.1,rate:50.6371107,amountUnit:"€"},{amount:8781791.1,rate:59.6371107,amountUnit:"€"},{amount:8781791.1,rate:4.6371107,amountUnit:"€"}]}],unit:"%"}},StackedBarChart={args:{width:"700px",height:"400px",tooltipFirstLineLabel:"content",tooltipSecondLineLabel:"content2",disableAccessibility:!1,stacked:!0,labels:["Category One","Category Two","Category Three"],colourSet:3,datasets:[{label:"Dataset One",stack:0,data:[{amount:103144.22,rate:100.1232806,amountUnit:"€"},{amount:297474.14,rate:3.2396087,amountUnit:"€"},{amount:8781791.1,rate:95.6371107,amountUnit:"€"}]},{label:"Dataset Two",stack:1,data:[{amount:103144.22,rate:1.1232806,amountUnit:"€"},{amount:297474.14,rate:3.2396087,amountUnit:"€"},{amount:8781791.1,rate:95.6371107,amountUnit:"€"}]},{label:"Dataset Three",stack:1,data:[{amount:103144.22,rate:1.1232806,amountUnit:"€"},{amount:297474.14,rate:3.2396087,amountUnit:"€"},{amount:8781791.1,rate:95.6371107,amountUnit:"€"}]}],unit:"%"}},__namedExportsOrder=["Default","MultipleData","StackedBarChart"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:'{\n  args: {\n    width: "500px",\n    height: "400px",\n    tooltipFirstLineLabel: "content",\n    tooltipSecondLineLabel: "content2",\n    disableAccessibility: false,\n    newPatternsOrder: [0, 4, 1, 2, 3, 5],\n    labels: ["Data One", "Data Two", "Data Three"],\n    colourSet: 0,\n    xAxisTitle: "X Axis Title",\n    yAxisTitle: "Y Axis Title",\n    datasets: [{\n      label: "Data One",\n      data: [{\n        amount: 163790.23,\n        rate: 1.719528,\n        amountUnit: "€"\n      }, {\n        amount: 217064,\n        rate: 2.278815,\n        amountUnit: "€"\n      }, {\n        amount: 9144447.23,\n        rate: 96.0016569,\n        amountUnit: "€"\n      }]\n    }, {\n      label: "Data Two",\n      data: [{\n        amount: 103144.22,\n        rate: 1.1232806,\n        amountUnit: "€"\n      }, {\n        amount: 297474.14,\n        rate: 3.2396087,\n        amountUnit: "€"\n      }, {\n        amount: 8781791.1,\n        rate: 95.6371107,\n        amountUnit: "€"\n      }]\n    }],\n    unit: "%"\n  }\n} satisfies Story',...Default.parameters?.docs?.source}}},MultipleData.parameters={...MultipleData.parameters,docs:{...MultipleData.parameters?.docs,source:{originalSource:'{\n  args: {\n    width: "700px",\n    height: "400px",\n    tooltipFirstLineLabel: "content",\n    tooltipSecondLineLabel: "content2",\n    disableAccessibility: false,\n    labels: ["Data One", "Data Two", "Data Three", "Data Four", "Data Five", "Data Six", "Data Seven", "Data Eight", "Data Nine", "Data Ten", "Data Eleven", "Data Twelve"],\n    colourSet: 1,\n    datasets: [{\n      label: "Data One",\n      data: [{\n        amount: 163790.23,\n        rate: 1.719528,\n        amountUnit: "€"\n      }, {\n        amount: 217064,\n        rate: 2.278815,\n        amountUnit: "€"\n      }, {\n        amount: 9144447.23,\n        rate: 6.0016569,\n        amountUnit: "€"\n      }, {\n        amount: 9144447.23,\n        rate: 46.0016569,\n        amountUnit: "€"\n      }, {\n        amount: 9144447.23,\n        rate: 66.0016569,\n        amountUnit: "€"\n      }, {\n        amount: 9144447.23,\n        rate: 9.0016569,\n        amountUnit: "€"\n      }, {\n        amount: 9144447.23,\n        rate: 46.0016569,\n        amountUnit: "€"\n      }, {\n        amount: 9144447.23,\n        rate: 26.0016569,\n        amountUnit: "€"\n      }, {\n        amount: 9144447.23,\n        rate: 81.0016569,\n        amountUnit: "€"\n      }, {\n        amount: 9144447.23,\n        rate: 11.0016569,\n        amountUnit: "€"\n      }, {\n        amount: 9144447.23,\n        rate: 90.0016569,\n        amountUnit: "€"\n      }, {\n        amount: 9144447.23,\n        rate: 50.0016569,\n        amountUnit: "€"\n      }]\n    }, {\n      label: "Data Two",\n      data: [{\n        amount: 103144.22,\n        rate: 1.1232806,\n        amountUnit: "€"\n      }, {\n        amount: 297474.14,\n        rate: 3.2396087,\n        amountUnit: "€"\n      }, {\n        amount: 8781791.1,\n        rate: 95.6371107,\n        amountUnit: "€"\n      }, {\n        amount: 8781791.1,\n        rate: 45.6371107,\n        amountUnit: "€"\n      }, {\n        amount: 8781791.1,\n        rate: 40.6371107,\n        amountUnit: "€"\n      }, {\n        amount: 8781791.1,\n        rate: 6.6371107,\n        amountUnit: "€"\n      }, {\n        amount: 8781791.1,\n        rate: 7.6371107,\n        amountUnit: "€"\n      }, {\n        amount: 8781791.1,\n        rate: 39.6371107,\n        amountUnit: "€"\n      }, {\n        amount: 8781791.1,\n        rate: 30.6371107,\n        amountUnit: "€"\n      }, {\n        amount: 8781791.1,\n        rate: 50.6371107,\n        amountUnit: "€"\n      }, {\n        amount: 8781791.1,\n        rate: 59.6371107,\n        amountUnit: "€"\n      }, {\n        amount: 8781791.1,\n        rate: 4.6371107,\n        amountUnit: "€"\n      }]\n    }],\n    unit: "%"\n  }\n} satisfies Story',...MultipleData.parameters?.docs?.source}}},StackedBarChart.parameters={...StackedBarChart.parameters,docs:{...StackedBarChart.parameters?.docs,source:{originalSource:'{\n  args: {\n    width: "700px",\n    height: "400px",\n    tooltipFirstLineLabel: "content",\n    tooltipSecondLineLabel: "content2",\n    disableAccessibility: false,\n    stacked: true,\n    labels: ["Category One", "Category Two", "Category Three"],\n    colourSet: 3,\n    datasets: [{\n      label: "Dataset One",\n      stack: 0,\n      data: [{\n        amount: 103144.22,\n        rate: 100.1232806,\n        amountUnit: "€"\n      }, {\n        amount: 297474.14,\n        rate: 3.2396087,\n        amountUnit: "€"\n      }, {\n        amount: 8781791.1,\n        rate: 95.6371107,\n        amountUnit: "€"\n      }]\n    }, {\n      label: "Dataset Two",\n      stack: 1,\n      data: [{\n        amount: 103144.22,\n        rate: 1.1232806,\n        amountUnit: "€"\n      }, {\n        amount: 297474.14,\n        rate: 3.2396087,\n        amountUnit: "€"\n      }, {\n        amount: 8781791.1,\n        rate: 95.6371107,\n        amountUnit: "€"\n      }]\n    }, {\n      label: "Dataset Three",\n      stack: 1,\n      data: [{\n        amount: 103144.22,\n        rate: 1.1232806,\n        amountUnit: "€"\n      }, {\n        amount: 297474.14,\n        rate: 3.2396087,\n        amountUnit: "€"\n      }, {\n        amount: 8781791.1,\n        rate: 95.6371107,\n        amountUnit: "€"\n      }]\n    }],\n    unit: "%"\n  }\n} satisfies Story',...StackedBarChart.parameters?.docs?.source}}}},"./src/components/bar/bar-chart.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,'.container {\n  -moz-osx-font-smoothing: grayscale;\n  -webkit-font-smoothing: antialiased;\n  font-weight: 400;\n  font-family: "Roboto", sans-serif;\n}\n\n.main {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  margin-bottom: 20px;\n}',""]),module.exports=___CSS_LOADER_EXPORT___.toString()}}]);